<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Dataset: bodydata | Applied Methods in Statistics</title>
  <meta name="description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Dataset: bodydata | Applied Methods in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  <meta name="github-repo" content="mathatistics/stat340-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Dataset: bodydata | Applied Methods in Statistics" />
  
  <meta name="twitter:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  

<meta name="author" content="Thore Egeland and Kathrine Frey Frøslie">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="dataset-birth.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113782065-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-113782065-1');
</script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Methods in Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practical Information</a><ul>
<li class="chapter" data-level="" data-path="lecture-and-exercise-plan.html"><a href="lecture-and-exercise-plan.html"><i class="fa fa-check"></i>Lecture and Exercise Plan</a></li>
<li class="chapter" data-level="" data-path="reference-books.html"><a href="reference-books.html"><i class="fa fa-check"></i>Reference Books</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="exercise-1-create-new-project.html"><a href="exercise-1-create-new-project.html"><i class="fa fa-check"></i>Exercise 1: Create New Project</a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html"><i class="fa fa-check"></i>Exercise 2: Importing data in R</a><ul>
<li><a href="exercise-2-importing-data-in-r.html#import-txt-or-csv">Import <code>txt</code> or <code>csv</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html#import-microsoft-excel-spreadsheet"><i class="fa fa-check"></i>Import Microsoft Excel spreadsheet</a></li>
<li><a href="exercise-2-importing-data-in-r.html#load-rdata-rda-or-rds">Load <code>rdata</code>, <code>rda</code> or <code>rds</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html#reading-data-from-clipboard-pasting-copied-data-into-an-r-object"><i class="fa fa-check"></i>Reading data from clipboard (“pasting” copied data into an R object)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3-exporting-data-to-a-file.html"><a href="exercise-3-exporting-data-to-a-file.html"><i class="fa fa-check"></i>Exercise 3: Exporting data to a file</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html"><i class="fa fa-check"></i>Exercise 4: Data Structure in R</a><ul>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#vector"><i class="fa fa-check"></i>Vector</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#matrix"><i class="fa fa-check"></i>Matrix</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#array"><i class="fa fa-check"></i>Array</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#list"><i class="fa fa-check"></i>List</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#data-frame"><i class="fa fa-check"></i>Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html"><i class="fa fa-check"></i>Exercise 5: Exploring the data</a><ul>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#structure-of-an-r-object"><i class="fa fa-check"></i>Structure of an R-object</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#accessing-elements-from-r-objects"><i class="fa fa-check"></i>Accessing elements from R-objects</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#view-data-in-rstudio"><i class="fa fa-check"></i>View Data in RStudio</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#summary-of-data"><i class="fa fa-check"></i>Summary of data</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#dimension-of-data"><i class="fa fa-check"></i>Dimension of data</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#lets-practice"><i class="fa fa-check"></i>Lets Practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html"><i class="fa fa-check"></i>Exercise 6: Subsets of data and logical operators</a><ul>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#logical-vector-and-index-vector"><i class="fa fa-check"></i>Logical vector and index vector</a></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#subsetting-data-frame"><i class="fa fa-check"></i>Subsetting data frame</a></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-7-graphics.html"><a href="exercise-7-graphics.html"><i class="fa fa-check"></i>Exercise 7: Graphics</a><ul>
<li class="chapter" data-level="" data-path="exercise-7-graphics.html"><a href="exercise-7-graphics.html#spice-up-the-plot"><i class="fa fa-check"></i>Spice up the plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i>Regression Analysis</a><ul>
<li class="chapter" data-level="" data-path="least-sqaures-app.html"><a href="least-sqaures-app.html"><i class="fa fa-check"></i>Least Sqaures App</a></li>
<li class="chapter" data-level="" data-path="dataset-birth.html"><a href="dataset-birth.html"><i class="fa fa-check"></i>Dataset: birth</a><ul>
<li><a href="dataset-birth.html#overview-of-data"><i class="fa fa-edit"></i> Overview of data</a></li>
<li><a href="dataset-birth.html#linear-regression"><i class="fa fa-book"></i> Linear Regression</a></li>
<li><a href="dataset-birth.html#regression-with-categories"><i class="fa fa-book"></i> Regression with categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataset-bodydata.html"><a href="dataset-bodydata.html"><i class="fa fa-check"></i>Dataset: bodydata</a><ul>
<li><a href="dataset-bodydata.html#training-samples"><i class="fa fa-book"></i> Training Samples</a></li>
<li><a href="dataset-bodydata.html#fitting-model"><i class="fa fa-edit"></i> Fitting Model</a></li>
<li><a href="dataset-bodydata.html#understanding-the-fitted-model"><i class="fa fa-edit"></i> Understanding the fitted Model</a></li>
<li><a href="dataset-bodydata.html#multiple-linear-regression-and-prediction"><i class="fa fa-edit"></i> Multiple Linear Regression and Prediction</a></li>
<li><a href="dataset-bodydata.html#extra-on-r-squared"><i class="fa fa-book"></i> Extra on R-squared</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a name="title" href="javascript:void(0)"><b>Lecturer:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/thore.egeland" target="blank">Thore Egeland</a></li></ul></li>
<li><a name="title" href="javascript:void(0)"><b>Assistent Teachers:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/raju.rimal" target="blank">Kathrine Frey Frøslie</a></li></ul></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Methods in Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataset-bodydata" class="section level2">
<h2>Dataset: bodydata</h2>
<div id="training-samples" class="section level3">
<h3><i class="fa fa-book"></i> Training Samples</h3>
<p>Create a training data set called bodytrain containing the first 20 observations only, by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bodytrain &lt;-<span class="st"> </span>bodydata[<span class="dv">1</span><span class="op">:</span><span class="dv">20</span>,]</code></pre></div>
</div>
<div id="fitting-model" class="section level3">
<h3><i class="fa fa-edit"></i> Fitting Model</h3>
<p>Fit one at a time three simple regression models with Weight as response and each of Height, Age and Circumference as predictors, name the models <code>Model1</code>, <code>Model2</code> and <code>Model3</code>, respectively. Use the <code>summary()</code> function on each model to print out a summary of the fitted models. Use the first 20 observations as your training data.</p>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Height, <span class="dt">data =</span> bodytrain)
model2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Age, <span class="dt">data =</span> bodytrain)
model3 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Circumference, <span class="dt">data =</span> bodytrain)</code></pre></div>
</div>
</div>
<div id="understanding-the-fitted-model" class="section level3">
<h3><i class="fa fa-edit"></i> Understanding the fitted Model</h3>
<ul>
<li>Test whether the three predictors are significant. Use a 5% test level.</li>
</ul>
<div class="ans">
<p>The summary result for <code>model1</code> is,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model1)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Height, data = bodytrain)

Residuals:
    Min      1Q  Median      3Q     Max 
-11.516  -2.596   0.026   2.914  11.745 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  -38.231     38.360   -1.00   0.3322   
Height         0.639      0.212    3.01   0.0076 **
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 5.84 on 18 degrees of freedom
Multiple R-squared: 0.334,
Adjusted R-squared: 0.297 
F-statistic: 9.04 on 1 and 18 DF,  p-value: 0.00757 </code></pre>
<p>Here, at 5% test level, Height is significant (p-value for Height is less than 0.05). The summary result for <code>model2</code> is,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model2)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Age, data = bodytrain)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.084  -3.918   0.898   4.251  12.439 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   80.745     14.563    5.54 0.000029 ***
Age           -0.159      0.625   -0.25      0.8    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 7.14 on 18 degrees of freedom
Multiple R-squared: 0.00359,
Adjusted R-squared: -0.0518 
F-statistic: 0.0648 on 1 and 18 DF,  p-value: 0.802 </code></pre>
<p>Here, at 5% test level, Age is not significant (p-value for age is greater than 0.05). Finally, the summary result for <code>model3</code> is,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(model3)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Circumference, data = bodytrain)

Residuals:
   Min     1Q Median     3Q    Max 
-8.937 -3.540  0.038  2.956  8.659 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      3.674     17.104    0.21  0.83234    
Circumference    0.914      0.212    4.30  0.00043 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 5.03 on 18 degrees of freedom
Multiple R-squared: 0.507,
Adjusted R-squared: 0.479 
F-statistic: 18.5 on 1 and 18 DF,  p-value: 0.000431 </code></pre>
<p>Here, at 5% test level, Circumference is significant (p-value for circumference is less than 0.05).</p>
</div>
<ul>
<li>Which model gives a better linear fit in terms of R-squared?</li>
</ul>
<div class="ans">
<p>The model with <code>Circumference</code> as predictor has highest <span class="math inline">\(R^2\)</span> among the models. This model explains 50.67 percent of variation present in the response <code>Weight</code>.</p>
</div>
<p>Compute the correlation matrix of the bodydtrain data by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cormat &lt;-<span class="st"> </span><span class="kw">cor</span>(bodytrain)</code></pre></div>
<p>You can square the correlations by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cormat <span class="op">^</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>               Weight  Height        Age Circumference
Weight        1.00000 0.33440 0.00358748    0.50671271
Height        0.33440 1.00000 0.00167276    0.06116116
Age           0.00359 0.00167 1.00000000    0.00000422
Circumference 0.50671 0.06116 0.00000422    1.00000000</code></pre>
<ul>
<li>Compare the squared correlations under the <code>Weight</code> column with the R-squared values from the three models.</li>
</ul>
<div class="ans">
<p>The square of correlation between each predictor variable with response is equals to the <span class="math inline">\(R^2\)</span> obtained in <code>model1</code>, <code>model2</code> and <code>model3</code>. However, this only applies to simple regression with one predictor.</p>
</div>
<p>If we “predict” the same observations as was used to fit the model, we get the so-called fitted values. These can be retrieved from the <code>model1</code> by <code>model1$fitted.values</code></p>
<ul>
<li>Compute the squared correlations between the <code>weights</code> of <code>bodytrain</code> and the fitted values of <code>model1</code>.</li>
</ul>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cors &lt;-<span class="st"> </span><span class="kw">cor</span>(bodytrain[ , <span class="dv">1</span>], model1<span class="op">$</span>fitted.values)
cors <span class="op">^</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>[1] 0.334</code></pre>
</div>
<ul>
<li>Compare with the R-squared of <code>model1</code></li>
</ul>
<div class="ans">
<p>The square of correlation between the fitted values from a model with the response is equal to the <span class="math inline">\(R^2\)</span> obtained from the model. This is a result which extends to multiple regression.</p>
</div>
<ul>
<li>For each model locate and compare the estimates for the error variance, <span class="math inline">\(\sigma^2\)</span>.</li>
</ul>
<div class="ans">
<p>By applying the anova() function to each model object we obtain the analysis of variance tables containing the MSE, i.e. the Mean Sum of Squares of the Error (Residuals), which is the estimator for the error variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(model1)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: Weight
          Df Sum Sq Mean Sq F value Pr(&gt;F)   
Height     1    308   308.3    9.04 0.0076 **
Residuals 18    614    34.1                  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(model2)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: Weight
          Df Sum Sq Mean Sq F value Pr(&gt;F)
Age        1      3     3.3    0.06    0.8
Residuals 18    919    51.0               </code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(model3)</code></pre></div>
<pre><code>Analysis of Variance Table

Response: Weight
              Df Sum Sq Mean Sq F value  Pr(&gt;F)    
Circumference  1    467     467    18.5 0.00043 ***
Residuals     18    455      25                    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</div>
<ul>
<li>Which model has the smallest error variance estimate?</li>
</ul>
<div class="ans">
<p>Model 3 has the smallest error variance estimate. We can also obtain the error variance estimate using the “Residual standard error” from the summary output since, <span class="math inline">\(MSE = s^2\)</span>.</p>
</div>
</div>
<div id="multiple-linear-regression-and-prediction" class="section level3">
<h3><i class="fa fa-edit"></i> Multiple Linear Regression and Prediction</h3>
<ul>
<li>Fit a model 4 with both <code>Height</code> and <code>Circumference</code> as predictors.</li>
</ul>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model4 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Height <span class="op">+</span><span class="st"> </span>Circumference, <span class="dt">data =</span> bodytrain)
<span class="kw">summary</span>(model4)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Height + Circumference, data = bodytrain)

Residuals:
   Min     1Q Median     3Q    Max 
-5.319 -3.536 -0.782  2.803  6.397 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -70.820     28.452   -2.49  0.02346 *  
Height           0.473      0.157    3.02  0.00770 ** 
Circumference    0.778      0.182    4.27  0.00051 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 4.17 on 17 degrees of freedom
Multiple R-squared: 0.679,
Adjusted R-squared: 0.641 
F-statistic:   18 on 2 and 17 DF,  p-value: 0.0000638 </code></pre>
</div>
<ul>
<li>Get test observations for prediction: (<em>Make a test data set called bodytest containing observations <code>21:40</code> (Hint: Check how we made <code>bodytrain</code> above)</em>)</li>
</ul>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bodytest &lt;-<span class="st"> </span>bodydata[<span class="dv">21</span><span class="op">:</span><span class="dv">40</span>, ]</code></pre></div>
</div>
<ul>
<li>Use <code>model4</code> to predict the Weights of the testdata.</li>
</ul>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pred &lt;-<span class="st"> </span><span class="kw">predict</span>(model4, <span class="dt">newdata =</span> bodytest)</code></pre></div>
</div>
<ul>
<li>Make a scatter plot of the actually observed weights of the test data and the predicted weights.</li>
</ul>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(bodytest[ , <span class="dv">1</span>], pred)</code></pre></div>
<p><img src="STAT340-2018_files/figure-html/unnamed-chunk-87-1.svg" width="672" /></p>
</div>
<ul>
<li>Compute the squared correlation between the actually observed Weights and the predicted weights.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cor</span>(pred, bodytest[ , <span class="dv">1</span>]) <span class="op">^</span><span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>[1] 0.714</code></pre>
<p>What you get here is a so-called “prediction R-squared” of this model.</p>
<ul>
<li>Compare with the R-squared of <code>model4</code></li>
</ul>
<div class="ans">
<p>The prediction R-squared is close to the R-squared of model4 (0.679) which indicates that the results from model4 generalize well to new observations.</p>
</div>
</div>
<div id="extra-on-r-squared" class="section level3">
<h3><i class="fa fa-book"></i> Extra on R-squared</h3>
<p>In statistics we aim at finding models which fit the data well. However, the R-squared may easily lead to overfitting of models, that is by including too many variables.</p>
<ul>
<li>Fit a model with all three predictors to the bodytrain data:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model5 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Height <span class="op">+</span><span class="st"> </span>Circumference <span class="op">+</span><span class="st"> </span>Age, <span class="dt">data =</span> bodytrain)
<span class="kw">summary</span>(model5)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Height + Circumference + Age, data = bodytrain)

Residuals:
   Min     1Q Median     3Q    Max 
-5.409 -3.390 -0.912  3.040  6.983 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    -66.579     30.010   -2.22  0.04133 *  
Height           0.477      0.160    2.98  0.00883 ** 
Circumference    0.777      0.186    4.18  0.00071 ***
Age             -0.209      0.373   -0.56  0.58235    
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 4.26 on 16 degrees of freedom
Multiple R-squared: 0.685,
Adjusted R-squared: 0.626 
F-statistic: 11.6 on 3 and 16 DF,  p-value: 0.000273 </code></pre>
<ul>
<li>Lets add some randomly generated junk from a normal distribution</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Junk1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">10</span>)
Junk2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>)
Junk3 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>)
model6 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Height <span class="op">+</span><span class="st"> </span>Circumference <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>
<span class="st">               </span>Junk1 <span class="op">+</span><span class="st"> </span>Junk2 <span class="op">+</span><span class="st"> </span>Junk3, <span class="dt">data =</span> bodytrain)
<span class="kw">summary</span>(model6)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Height + Circumference + Age + Junk1 + 
    Junk2 + Junk3, data = bodytrain)

Residuals:
   Min     1Q Median     3Q    Max 
 -4.90  -2.94  -1.18   2.96   6.47 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   -45.2110    34.4211   -1.31   0.2117   
Height          0.3716     0.1850    2.01   0.0659 . 
Circumference   0.7785     0.2384    3.27   0.0061 **
Age            -0.3277     0.4102   -0.80   0.4387   
Junk1          -0.1569     0.1394   -1.13   0.2808   
Junk2           0.1641     0.1367    1.20   0.2512   
Junk3          -0.0771     0.1361   -0.57   0.5807   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 4.34 on 13 degrees of freedom
Multiple R-squared: 0.734,
Adjusted R-squared: 0.611 
F-statistic: 5.98 on 6 and 13 DF,  p-value: 0.00346 </code></pre>
<div id="exercises" class="section level5">
<h5><i class="fa fa-edit"></i> Exercises</h5>
<ul>
<li>Compare models 5 and 6. What happens to the R-squared? (<em>Compare also the adjusted R-squared values for models 5 and 6.</em>)</li>
</ul>
<div class="ans">
<p>The results will vary from time to time since we sample random junk, but in general we will observe that R-squared increase, whereas the adjuste R-squared decrease as we add more junk variables.</p>
</div>
<ul>
<li>Try to add 3 more junk variables, <code>Junk4</code>, <code>Junk5</code> and <code>Junk6</code>.</li>
</ul>
<div class="ans">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Junk4 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">10</span>)
Junk5 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>)
Junk6 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">10</span>)
model6 &lt;-<span class="st"> </span><span class="kw">lm</span>(Weight <span class="op">~</span><span class="st"> </span>Height <span class="op">+</span><span class="st"> </span>Circumference <span class="op">+</span><span class="st"> </span>Age <span class="op">+</span><span class="st"> </span>Junk1 <span class="op">+</span><span class="st"> </span>Junk2 <span class="op">+</span><span class="st"> </span>Junk3 <span class="op">+</span>
<span class="st">               </span>Junk4 <span class="op">+</span><span class="st"> </span>Junk5 <span class="op">+</span><span class="st"> </span>Junk6, <span class="dt">data =</span> bodytrain)
<span class="kw">summary</span>(model6)</code></pre></div>
<pre><code>
Call:
lm(formula = Weight ~ Height + Circumference + Age + Junk1 + 
    Junk2 + Junk3 + Junk4 + Junk5 + Junk6, data = bodytrain)

Residuals:
   Min     1Q Median     3Q    Max 
 -4.47  -2.07   1.04   1.92   4.34 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   -94.5392    34.6101   -2.73   0.0211 * 
Height          0.6117     0.1901    3.22   0.0092 **
Circumference   0.7818     0.2005    3.90   0.0030 **
Age            -0.0701     0.3488   -0.20   0.8448   
Junk1           0.0822     0.1653    0.50   0.6295   
Junk2          -0.0209     0.1469   -0.14   0.8897   
Junk3           0.0488     0.1323    0.37   0.7197   
Junk4          -0.2964     0.1181   -2.51   0.0309 * 
Junk5           0.1626     0.1280    1.27   0.2326   
Junk6          -0.0469     0.0826   -0.57   0.5822   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 3.55 on 10 degrees of freedom
Multiple R-squared: 0.863,
Adjusted R-squared: 0.74 
F-statistic: 7.01 on 9 and 10 DF,  p-value: 0.00269 </code></pre>
</div>
<ul>
<li>Observe the R-squared values (<em>What is the lesson to be learned here?</em>)</li>
</ul>
<div class="ans">
<p>Adding variables and only observing R-squared may be misleading. We should at least also keep in mind that a simple model is better. Hence, if adding more variables does not increase R-squared very much, we should keep the simpler model. If in addition the difference between the R-squared and the adjusted R-squared starts to get large, it is a clear indicator of overfitting.</p>
</div>

</div>
</div>
</div>
<!-- </div> -->
<script>
  ans_btn_html = '<a class = "btn-ans"><span class="label label-success no-print">&lt;ANS/&gt;</span></a>';
  showAns_btn = '<a class="showAns-btn btn pull-right js-toolbar-action">Show Answers</a>';
  hideAns_btn = '<a class="hideAns-btn btn pull-right js-toolbar-action" style="display:none;">Hide Answers</a>';
  
  // Adding Extra Menus in Navigation
  
  // Adding button on before each answer:::
  $(".ans").before(ans_btn_html);
  $('.btn-ans').each(function(){
    $(this).next('.ans').andSelf().wrapAll('<div class="wrap-ans"/>');
  });
  $('.btn-ans').click(function(){
    $(this).siblings('.ans').toggle(400);
  });
  
if ($(".ans").length > 0){
    $('.book-header').prepend(showAns_btn, hideAns_btn);
    $('.showAns-btn').show();
    $('.showAns-btn').click(function(){
      $('.btn-ans').hide(400);
      $('.ans').show(400);
      $('.hideAns-btn').show();
      $(this).hide();
      $('.hideAns-btn').click(function(){
        $('.btn-ans').show(400);
        $('.ans').hide(400);
        $('.showAns-btn').show();
        $(this).hide();
      });
    });
  }

var chap = "week-two"
if(window.location.href.indexOf(chap) != -1){
  var now = new Date();
  var release = new Date("August 21, 2016");
  if(now < release){
    $(".ans, .btn-ans, .showAns-btn, .hideAns-btn").hide()
  }
}

$('.ans p:has(img)').css('text-align', 'center');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82812028-1', 'auto');
  ga('send', 'pageview');

</script>
            </section>

          </div>
        </div>
      </div>
<a href="dataset-birth.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["STAT340-2018.pdf", "STAT340-2018.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
