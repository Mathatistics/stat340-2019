<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Exercises and Diet | Applied Methods in Statistics</title>
  <meta name="description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Exercises and Diet | Applied Methods in Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  <meta name="github-repo" content="mathatistics/stat340-2019" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Exercises and Diet | Applied Methods in Statistics" />
  
  <meta name="twitter:description" content="This contains the weekly exercises related to Applied Methods in Statistics (STAT340)" />
  

<meta name="author" content="Raju, Rimal, Kathrine Frey Frøslie and Thore Egeland">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="mixed-effect-model.html">
<link rel="next" href="exam-questions.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-113782065-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-113782065-1');
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Applied Methods in Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Practical Information</a></li>
<li class="chapter" data-level="" data-path="getting-started.html"><a href="getting-started.html"><i class="fa fa-check"></i>Getting Started</a><ul>
<li class="chapter" data-level="" data-path="exercise-1-create-new-project.html"><a href="exercise-1-create-new-project.html"><i class="fa fa-check"></i>Exercise 1: Create New Project</a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html"><i class="fa fa-check"></i>Exercise 2: Importing data in R</a><ul>
<li><a href="exercise-2-importing-data-in-r.html#import-txt-or-csv">Import <code>txt</code> or <code>csv</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html#import-microsoft-excel-spreadsheet"><i class="fa fa-check"></i>Import Microsoft Excel spreadsheet</a></li>
<li><a href="exercise-2-importing-data-in-r.html#load-rdata-rda-or-rds">Load <code>rdata</code>, <code>rda</code> or <code>rds</code></a></li>
<li class="chapter" data-level="" data-path="exercise-2-importing-data-in-r.html"><a href="exercise-2-importing-data-in-r.html#reading-data-from-clipboard-pasting-copied-data-into-an-r-object"><i class="fa fa-check"></i>Reading data from clipboard (“pasting” copied data into an R object)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3-exporting-data-to-a-file.html"><a href="exercise-3-exporting-data-to-a-file.html"><i class="fa fa-check"></i>Exercise 3: Exporting data to a file</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html"><i class="fa fa-check"></i>Exercise 4: Data Structure in R</a><ul>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#vector"><i class="fa fa-check"></i>Vector</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#matrix"><i class="fa fa-check"></i>Matrix</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#array"><i class="fa fa-check"></i>Array</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#list"><i class="fa fa-check"></i>List</a></li>
<li class="chapter" data-level="" data-path="exercise-4-data-structure-in-r.html"><a href="exercise-4-data-structure-in-r.html#data-frame"><i class="fa fa-check"></i>Data Frame</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html"><i class="fa fa-check"></i>Exercise 5: Exploring the data</a><ul>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#structure-of-an-r-object"><i class="fa fa-check"></i>Structure of an R-object</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#accessing-elements-from-r-objects"><i class="fa fa-check"></i>Accessing elements from R-objects</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#view-data-in-rstudio"><i class="fa fa-check"></i>View Data in RStudio</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#summary-of-data"><i class="fa fa-check"></i>Summary of data</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#dimension-of-data"><i class="fa fa-check"></i>Dimension of data</a></li>
<li class="chapter" data-level="" data-path="exercise-5-exploring-the-data.html"><a href="exercise-5-exploring-the-data.html#lets-practice"><i class="fa fa-check"></i>Lets Practice</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html"><i class="fa fa-check"></i>Exercise 6: Subsets of data and logical operators</a><ul>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#logical-vector-and-index-vector"><i class="fa fa-check"></i>Logical vector and index vector</a></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#subsetting-data-frame"><i class="fa fa-check"></i>Subsetting data frame</a></li>
<li class="chapter" data-level="" data-path="exercise-6-subsets-of-data-and-logical-operators.html"><a href="exercise-6-subsets-of-data-and-logical-operators.html#exercise-1"><i class="fa fa-check"></i>Exercise</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-7-graphics.html"><a href="exercise-7-graphics.html"><i class="fa fa-check"></i>Exercise 7: Graphics</a><ul>
<li class="chapter" data-level="" data-path="exercise-7-graphics.html"><a href="exercise-7-graphics.html#spice-up-the-plot"><i class="fa fa-check"></i>Spice up the plot</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="regression-analysis.html"><a href="regression-analysis.html"><i class="fa fa-check"></i>Regression Analysis</a><ul>
<li class="chapter" data-level="" data-path="least-squares-app.html"><a href="least-squares-app.html"><i class="fa fa-check"></i>Least Squares App</a></li>
<li class="chapter" data-level="" data-path="dataset-birth.html"><a href="dataset-birth.html"><i class="fa fa-check"></i>Dataset: birth</a><ul>
<li><a href="dataset-birth.html#overview-of-data"><i class="fa fa-edit"></i> Overview of data</a></li>
<li><a href="dataset-birth.html#linear-regression"><i class="fa fa-book"></i> Linear Regression</a></li>
<li><a href="dataset-birth.html#regression-with-categories"><i class="fa fa-book"></i> Regression with categories</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataset-bodydata.html"><a href="dataset-bodydata.html"><i class="fa fa-check"></i>Dataset: bodydata</a><ul>
<li><a href="dataset-bodydata.html#training-samples"><i class="fa fa-book"></i> Training Samples</a></li>
<li><a href="dataset-bodydata.html#fitting-model"><i class="fa fa-edit"></i> Fitting Model</a></li>
<li><a href="dataset-bodydata.html#understanding-the-fitted-model"><i class="fa fa-edit"></i> Understanding the fitted Model</a></li>
<li><a href="dataset-bodydata.html#multiple-linear-regression-and-prediction"><i class="fa fa-edit"></i> Multiple Linear Regression and Prediction</a></li>
<li><a href="dataset-bodydata.html#extra-on-r-squared"><i class="fa fa-book"></i> Extra on R-squared</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html"><i class="fa fa-check"></i>Dataset: mtcars</a><ul>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-1-model-fitting"><i class="fa fa-check"></i>Ex-1: Model Fitting</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-2-indicator-variable"><i class="fa fa-check"></i>Ex-2: Indicator variable</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-3-comparing-models---partial-f-test"><i class="fa fa-check"></i>Ex-3: Comparing models - Partial F-test</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-4-influential-measurements"><i class="fa fa-check"></i>Ex-4: Influential measurements</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-5-model-selection"><i class="fa fa-check"></i>Ex-5: Model selection</a></li>
<li class="chapter" data-level="" data-path="dataset-mtcars.html"><a href="dataset-mtcars.html#ex-6-model-validation"><i class="fa fa-check"></i>Ex-6: Model validation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="analysis-of-variance.html"><a href="analysis-of-variance.html"><i class="fa fa-check"></i>Analysis of variance</a><ul>
<li class="chapter" data-level="" data-path="chlorine-levels-in-cities.html"><a href="chlorine-levels-in-cities.html"><i class="fa fa-check"></i>Chlorine levels in cities</a></li>
<li class="chapter" data-level="" data-path="data-from-the-nsr-education-test.html"><a href="data-from-the-nsr-education-test.html"><i class="fa fa-check"></i>Data from the NSR education test</a></li>
<li class="chapter" data-level="" data-path="barley-data.html"><a href="barley-data.html"><i class="fa fa-check"></i>Barley Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis-pca.html"><a href="multivariate-analysis-pca.html"><i class="fa fa-check"></i>Multivariate Analysis (PCA)</a><ul>
<li class="chapter" data-level="" data-path="track-and-field-data.html"><a href="track-and-field-data.html"><i class="fa fa-check"></i>Track and Field data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multivariate-analysis-pcr-pls.html"><a href="multivariate-analysis-pcr-pls.html"><i class="fa fa-check"></i>Multivariate Analysis (PCR, PLS)</a><ul>
<li class="chapter" data-level="" data-path="prediction-of-cow-milk-percentage.html"><a href="prediction-of-cow-milk-percentage.html"><i class="fa fa-check"></i>Prediction of cow milk percentage</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="discrimination-and-classification.html"><a href="discrimination-and-classification.html"><i class="fa fa-check"></i>Discrimination and classification</a><ul>
<li class="chapter" data-level="" data-path="iris-dataset.html"><a href="iris-dataset.html"><i class="fa fa-check"></i>Iris Dataset</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="generalized-linear-model.html"><a href="generalized-linear-model.html"><i class="fa fa-check"></i>Generalized Linear Model</a><ul>
<li class="chapter" data-level="" data-path="species-data.html"><a href="species-data.html"><i class="fa fa-check"></i>Species Data</a></li>
<li class="chapter" data-level="" data-path="taxonomy-data.html"><a href="taxonomy-data.html"><i class="fa fa-check"></i>Taxonomy Data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="random-effect-model.html"><a href="random-effect-model.html"><i class="fa fa-check"></i>Random Effect Model</a><ul>
<li class="chapter" data-level="" data-path="litter-sizes.html"><a href="litter-sizes.html"><i class="fa fa-check"></i>Litter sizes</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="mixed-effect-model.html"><a href="mixed-effect-model.html"><i class="fa fa-check"></i>Mixed Effect Model</a><ul>
<li class="chapter" data-level="" data-path="exercises-and-diet.html"><a href="exercises-and-diet.html"><i class="fa fa-check"></i>Exercises and Diet</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exam-questions.html"><a href="exam-questions.html"><i class="fa fa-check"></i>Exam Questions</a><ul>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html"><i class="fa fa-check"></i>Exam 2016</a><ul>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html#exercise-1-1"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html#exersise-2"><i class="fa fa-check"></i>Exersise 2</a></li>
<li class="chapter" data-level="" data-path="exam-2016.html"><a href="exam-2016.html#exercise-3"><i class="fa fa-check"></i>Exercise 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html"><i class="fa fa-check"></i>Exam 2017</a><ul>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-1-2"><i class="fa fa-check"></i>Exercise 1</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-2"><i class="fa fa-check"></i>Exercise 2</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-3-1"><i class="fa fa-check"></i>Exercise 3</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#exercise-4"><i class="fa fa-check"></i>Exercise 4</a></li>
<li class="chapter" data-level="" data-path="exam-2017.html"><a href="exam-2017.html#appendix-to-exam-stat340"><i class="fa fa-check"></i>Appendix to exam STAT340</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a name="title" href="javascript:void(0)"><b>Lecturer:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/thore.egeland" target="blank">Thore Egeland</a></li></ul></li>
<li><a name="title" href="javascript:void(0)"><b>Assistent Teachers:</b></a><ul>
<li><a href="https://www.nmbu.no/ans/raju.rimal" target="blank">Kathrine Frey Frøslie</a></li></ul></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applied Methods in Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises-and-diet" class="section level2">
<h2>Exercises and Diet</h2>
<p>The data and some examples are found at <a href="https://stats.idre.ucla.edu/r/seminars/repeated-measures-analysis-with-r/">statistics.ats.ucla.edu</a></p>
<p>The data called exer, consists of people who were randomly assigned to two different diets: low-fat and not low-fat and three different types of exercise: at rest, walking leisurely and running. Their pulse rate was measured at three different time points during their assigned exercise: at 1 minute, 15 minutes and 30 minutes.</p>
<p>Upon downloading the data, you can load and plot the data by</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(exer, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">aspect =</span> <span class="st">&quot;fill&quot;</span>, <span class="dt">key =</span> <span class="ot">NULL</span>)</code></pre>
<p><img src="STAT340-2018_files/figure-html/unnamed-chunk-200-1.svg" width="672" /></p>
<p>You will see six plots with heading’s like <code>2:1</code> which means <code>diet=2</code> and exercises <code>type=1</code>.
In each plot we have three repeated measurements for each of 5 people.</p>
<p>In these exercises you will be asked to answer some questions. Use the R-outputs to the extent your find it necessary.</p>
<ol style="list-style-type: lower-alpha">
<li>Below is a output from a linear model fitted to the data. State the model that has been fitted and the assumptions made. Which parametrization is used?</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">contrasts =</span> <span class="kw">c</span>(<span class="st">&quot;contr.sum&quot;</span>, <span class="st">&quot;contr.poly&quot;</span>))
mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(pulse <span class="op">~</span><span class="st"> </span>(time <span class="op">+</span><span class="st"> </span>diet <span class="op">+</span><span class="st"> </span>exertype) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>, <span class="dt">data =</span> exer)
<span class="kw">summary</span>(mod1)</code></pre>
<pre><code>
Call:
lm(formula = pulse ~ (time + diet + exertype)^2, data = exer)

Residuals:
    Min      1Q  Median      3Q     Max 
-19.233  -5.088   0.683   4.913  26.933 

Coefficients:
                    Estimate Std. Error t value   Pr(&gt;|t|)    
(Intercept)           88.400      2.100   42.09    &lt; 2e-16 ***
time                   5.650      0.972    5.81 0.00000012 ***
diet(1)               -0.178      2.100   -0.08    0.93276    
exertype(1)            1.233      2.970    0.42    0.67911    
exertype(2)            4.000      2.970    1.35    0.18192    
time:diet(1)          -1.783      0.972   -1.83    0.07036 .  
time:exertype(1)      -5.050      1.375   -3.67    0.00043 ***
time:exertype(2)      -4.250      1.375   -3.09    0.00275 ** 
diet(1):exertype(1)    2.244      1.123    2.00    0.04899 *  
diet(1):exertype(2)    2.011      1.123    1.79    0.07703 .  
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

s: 7.53 on 80 degrees of freedom
Multiple R-squared: 0.769,
Adjusted R-squared: 0.743 
F-statistic: 29.6 on 9 and 80 DF,  p-value: &lt;2e-16 </code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(mod1)</code></pre>
<pre><code>Analysis of Variance Table

Response: pulse
              Df Sum Sq Mean Sq F value      Pr(&gt;F)    
time           1   1915    1915   33.77 0.000000121 ***
diet           1   1262    1262   22.25 0.000010015 ***
exertype       2   8326    4163   73.39     &lt; 2e-16 ***
time:diet      1    191     191    3.36      0.0704 .  
time:exertype  2   2601    1301   22.93 0.000000013 ***
diet:exertype  2    816     408    7.19      0.0013 ** 
Residuals     80   4538      57                        
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="ans">
<p>We can write the model in this way:</p>
<p><span class="math display">\[
\begin{aligned}
\mathtt{pulse}_{ijkl} = \mu + &amp;\beta\;\mathtt{time}_{l} + \mathtt{diet}_j + \mathtt{exertype}_k + \beta\;\mathtt{time}_{l}\cdot\mathtt{exertype}_{k} +  \\
&amp;\beta\;\mathtt{time}_{l}\cdot\mathtt{diet}_{jl} +  \mathtt{diet}_j\cdot\mathtt{exertype}_k + \epsilon_{ijkl}
\end{aligned}
\]</span></p>
<p>Where we assume that the errors are identically and independently distributed (iid) as:</p>
<p><span class="math inline">\(\epsilon_{ijkl} \sim N(0, \sigma^2)\)</span> for all <span class="math inline">\(j = 1, 2\)</span> (For Diet); <span class="math inline">\(k = 1, 2, 3\)</span> (For Exercise Type) and <span class="math inline">\(l = 1, 2, 3\)</span> (For individual time points)</p>
<p>In orther words it is a linear model with main effects of time, diet and exercise type,
plus all second-order interactions between these.</p>
<p>Remark: From the ANOVA-table output we may observe that time
has only one degree of freedom (thus one parameter is estimated for the effect of time)
which means that time is assumed to be a continuous effect. If time alternatively was
modelled as a categorical variable, it would have had 2 degrees of freedom in the ANOVA table
(the number of time-levels minus one).</p>
<p>Further, a sum-to-zero parametrization is used for all categorical effects, for instance,
we assume that the two diet effects sum to zero, hence the estimate of <code>diet(2)</code> is:
<code>diet(2) = -diet(1) = -(-0.1778) = 0.1778</code></p>
<p>The three exercise type effects likewise, that is:
<code>exertype(3) = -(exertype(1) + exertype(2)) = -(1.2333 + 4.0000) = -5.233</code></p>
<p>For interactions between categorical effects, the effects sum to zero if we keep one variable
fixed at one level and sum across the levels of the other. E.g. for diet 1 the interaction effects with exercise types 1, 2 and 3 sum to zero, and so on. That is:
we would from the ouput find:</p>
<p><code>diet(1):exertype(3) = -(diet(1):exertype(1) + diet(1):exertype(2)) = -(2.2444 + 2.0111) = -4.256</code></p>
<p>However, it also means that for fixed level 3 for exercise type, the diet effects should sum to zero. That is:</p>
<p><code>diet(2):exertype(3) = - diet(1):exertype(3) = -(-4.256) = 4.256</code></p>
<p>For interactions between the continuous variable time and a catergorical variable, the effects sum to zero across the levels of the categorical variable if we keep time fixed.</p>
<p>Hence:
<code>time:diet(2) = -time:diet(1) = -(-1.783) = 1.783</code></p>
<p>and
<code>time:exertype(3) = -(time:exertype(1) + time:exertype(2)) = -(-5.05 - 4.25)=  9.30</code></p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>Write up the fitted model for pulse as a function of time for the special case of <code>diet=1</code>
and <code>exertype=1</code>. Do the same for <code>diet=2</code> and <code>exertype=3</code>.</li>
</ol>
<div class="ans">
<p>The fitted model for <code>diet=1</code> and <code>exertype=1</code> is found directly by selecting the estimated
coefficients from the output for which diet=1 and exertype=1:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\mathtt{pulse}} &amp;= 88.4 + 5.65 \mathtt{time} -0.178 + 1.233-1.783 \mathtt{time} -5.05 \mathtt{time} + 2.244 \\
&amp;= 91.699 -1.183 \mathtt{time}
\end{aligned}
\]</span></p>
<p>Similarly, using the estimates found above through the sum-to-zero parametrizations, the fitted model for <code>diet=2</code> and <code>exertype=3</code> becomes:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\mathtt{pulse}} &amp;= 87.6 + 16.733 \mathtt{time}
\end{aligned}
\]</span></p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>What is the estimated noise variance? Give an interpretation of the estimated time effect (5.65) for a person with limited statistics knowledge.</li>
</ol>
<div class="ans">
<p>The estimated noise variance is <span class="math inline">\(\hat{\sigma}^{2}\)</span> = MSE= 56.724. The estimate of <code>time</code> variable which is 5.65 refers to the average change in pulse per unit increase in time, for persons being part of this study.</p>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>The anova table gives significant interaction between time and exertype. Use the graphs above to explain why there is an interaction between these two variables.</li>
</ol>
<div class="ans">
<p>Since the interaction term is significant, for each individual, the line representing the pulse measured at three time points are inclined different (not parallel) which also says that the pulse for an individual under different exercise type changes differently over time.</p>
</div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Are there any problems related to the model assumptions for the model fitted in a. ?</li>
</ol>
<div class="ans">
<p>Model 1 is based on the assumption that all error terms (and hence all observations) are
independent. Since we know that there are three repeated observations on each person, we
should expect that observations made on the same person are dependent. For instance,
a person with low puls at time 1 is expected to also have (relatively) low puls at time
points2 and 3. The Figure below confirms this tendency, especially for exercise types 1 and 2.
We see that the residuals of any given person tend to be either above or below the fitted lines.</p>
<p><img src="STAT340-2018_files/figure-html/unnamed-chunk-203-1.svg" width="672" /></p>
</div>
<ol start="6" style="list-style-type: lower-alpha">
<li>Another analysis was performed as shown below. Describe the difference between mod2 and mod1. Are there any extra parameters estimated? Why is mod2 probably a more reasonable model than mod1?</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r">mod2 &lt;-<span class="st"> </span><span class="kw">lme</span>(pulse <span class="op">~</span><span class="st"> </span>(time <span class="op">+</span><span class="st"> </span>diet <span class="op">+</span><span class="st"> </span>exertype) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>, 
            <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id, <span class="dt">data =</span> exer)
<span class="kw">summary</span>(mod2)</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: exer 
  AIC BIC logLik
  610 639   -293

Random effects:
 Formula: ~1 | id
        (Intercept) Residual
StdDev:        3.79     6.62

Fixed effects: pulse ~ (time + diet + exertype)^2 
                Value Std.Error DF t-value p-value
(Intercept)      88.4     1.971 56    44.8  0.0000
time              5.6     0.854 56     6.6  0.0000
diet1            -0.2     1.971 24    -0.1  0.9289
exertype1         1.2     2.788 24     0.4  0.6621
exertype2         4.0     2.788 24     1.4  0.1642
time:diet1       -1.8     0.854 56    -2.1  0.0414
time:exertype1   -5.1     1.208 56    -4.2  0.0001
time:exertype2   -4.3     1.208 56    -3.5  0.0009
diet1:exertype1   2.2     1.390 24     1.6  0.1193
diet1:exertype2   2.0     1.390 24     1.4  0.1607
 Correlation: 
                (Intr) time   diet1  exrty1 exrty2 tm:dt1 tm:xr1 tm:xr2
time            -0.867                                                 
diet1            0.000  0.000                                          
exertype1        0.000  0.000  0.000                                   
exertype2        0.000  0.000  0.000 -0.500                            
time:diet1       0.000  0.000 -0.867  0.000  0.000                     
time:exertype1   0.000  0.000  0.000 -0.867  0.433  0.000              
time:exertype2   0.000  0.000  0.000  0.433 -0.867  0.000 -0.500       
diet1:exertype1  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000
diet1:exertype2  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000
                dt1:x1
time                  
diet1                 
exertype1             
exertype2             
time:diet1            
time:exertype1        
time:exertype2        
diet1:exertype1       
diet1:exertype2 -0.500

Standardized Within-Group Residuals:
   Min     Q1    Med     Q3    Max 
-2.576 -0.566 -0.038  0.458  3.475 

Number of Observations: 90
Number of Groups: 30 </code></pre>
<div class="ans">
<p>Model 2 assumes a random intercept for each individual and the random intercept is assumed to follow <span class="math inline">\(N(0, \sigma_\alpha^2)\)</span>. So, <span class="math inline">\(\sigma_\alpha\)</span> is an extra parameters to be estimated. From model 2, we can obtain a separate fitted line for each individual, which is more resonable and which take better into account that we may have dependence between observations made on the same person.</p>
<p><img src="STAT340-2018_files/figure-html/unnamed-chunk-205-1.svg" width="672" /></p>
</div>
<ol start="7" style="list-style-type: lower-alpha">
<li>For models containing random effects there is a function <code>ranef</code> in the <code>nlme</code>-package
which displays the predicted random effects. The first 5 random effects are shown below
with “rowname” equal to the id number of a given person. Explain what it means that person
with id=4 has a random effect of -3.802.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ranef</span>(mod2)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,,drop =<span class="st"> </span>F]</code></pre>
<pre><code>  (Intercept)
4      -3.802
1      -1.653
5       0.992
2       1.157
3       3.306</code></pre>
<div class="ans">
<p>This means that person with <code>id=4</code> has on average 3.802 units lower pulse than the average person, keeping all other variables fixed.</p>
</div>
<ol start="8" style="list-style-type: lower-alpha">
<li>A third model was analysed by:</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(nlme)
mod3 &lt;-<span class="st"> </span><span class="kw">lme</span>(pulse <span class="op">~</span><span class="st"> </span>(time <span class="op">+</span><span class="st"> </span>diet <span class="op">+</span><span class="st"> </span>exertype) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>, 
            <span class="dt">random =</span> <span class="op">~</span><span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id, <span class="dt">correlation =</span> <span class="kw">corAR1</span>(), 
            <span class="dt">data =</span> exer)
<span class="kw">summary</span>(mod3)</code></pre>
<pre><code>Linear mixed-effects model fit by REML
 Data: exer 
  AIC BIC logLik
  611 642   -293

Random effects:
 Formula: ~1 | id
        (Intercept) Residual
StdDev:        1.45     7.47

Correlation Structure: AR(1)
 Formula: ~1 | id 
 Parameter estimate(s):
  Phi 
0.254 
Fixed effects: pulse ~ (time + diet + exertype)^2 
                Value Std.Error DF t-value p-value
(Intercept)      88.2     2.099 56    42.0  0.0000
time              5.6     0.933 56     6.1  0.0000
diet1            -0.2     2.099 24    -0.1  0.9259
exertype1         1.4     2.968 24     0.5  0.6421
exertype2         4.0     2.968 24     1.4  0.1861
time:diet1       -1.8     0.933 56    -1.9  0.0611
time:exertype1   -5.1     1.320 56    -3.8  0.0003
time:exertype2   -4.2     1.320 56    -3.2  0.0021
diet1:exertype1   2.2     1.357 24     1.7  0.1111
diet1:exertype2   2.1     1.357 24     1.5  0.1430
 Correlation: 
                (Intr) time   diet1  exrty1 exrty2 tm:dt1 tm:xr1 tm:xr2
time            -0.889                                                 
diet1            0.000  0.000                                          
exertype1        0.000  0.000  0.000                                   
exertype2        0.000  0.000  0.000 -0.500                            
time:diet1       0.000  0.000 -0.889  0.000  0.000                     
time:exertype1   0.000  0.000  0.000 -0.889  0.445  0.000              
time:exertype2   0.000  0.000  0.000  0.445 -0.889  0.000 -0.500       
diet1:exertype1  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000
diet1:exertype2  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.000
                dt1:x1
time                  
diet1                 
exertype1             
exertype2             
time:diet1            
time:exertype1        
time:exertype2        
diet1:exertype1       
diet1:exertype2 -0.500

Standardized Within-Group Residuals:
   Min     Q1    Med     Q3    Max 
-2.470 -0.656  0.108  0.634  3.595 

Number of Observations: 90
Number of Groups: 30 </code></pre>
<p>How does mod 3 differ from mod2 in its model assumptions? Are there any extra parameters estimated?</p>
<div class="ans">
<p>Apart from all the assumption in Model 2, Model 3 also assumes a first order autocorrelation between the error terms. In simple words, observation far from each other tend to be less correlated.</p>
</div>
<ol style="list-style-type: lower-roman">
<li>Which of mod2 and mod3 is to prefer. Explain why based on the output below.</li>
</ol>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(mod2, mod3)</code></pre>
<pre><code>     Model df AIC BIC logLik   Test L.Ratio p-value
mod2     1 12 610 639   -293                       
mod3     2 13 611 642   -293 1 vs 2   0.702   0.402</code></pre>
<div class="ans">
<p>The <code>anova()</code> function used here returns the result of a likelihood-ratio test (a chi-square test). The null-hypothesis for the test is that the two models fit the data equally well. The p-value is large, and we retain the null-hypothesis. Hence, the extra refinement introduced
in mod3 is not improving the model fit significantly, and we may keep the simpler mod2.</p>
</div>

</div>
<!-- </div> -->
<script>
  ans_btn_html = '<a class = "btn-ans"><span class="label label-success no-print">&lt;ANS/&gt;</span></a>';
  showAns_btn = '<a class="showAns-btn btn pull-right js-toolbar-action">Show Answers</a>';
  hideAns_btn = '<a class="hideAns-btn btn pull-right js-toolbar-action" style="display:none;">Hide Answers</a>';
  
  // Adding Extra Menus in Navigation
  
  // Adding button on before each answer:::
  $(".ans").before(ans_btn_html);
  $('.btn-ans').each(function(){
    $(this).next('.ans').andSelf().wrapAll('<div class="wrap-ans"/>');
  });
  $('.btn-ans').click(function(){
    $(this).siblings('.ans').toggle(400);
  });
  
if ($(".ans").length > 0){
    $('.book-header').prepend(showAns_btn, hideAns_btn);
    $('.showAns-btn').show();
    $('.showAns-btn').click(function(){
      $('.btn-ans').hide(400);
      $('.ans').show(400);
      $('.hideAns-btn').show();
      $(this).hide();
      $('.hideAns-btn').click(function(){
        $('.btn-ans').show(400);
        $('.ans').hide(400);
        $('.showAns-btn').show();
        $(this).hide();
      });
    });
  }

var chap = "week-two"
if(window.location.href.indexOf(chap) != -1){
  var now = new Date();
  var release = new Date("August 21, 2016");
  if(now < release){
    $(".ans, .btn-ans, .showAns-btn, .hideAns-btn").hide()
  }
}

$('.ans p:has(img)').css('text-align', 'center');
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-82812028-1', 'auto');
  ga('send', 'pageview');

</script>
            </section>

          </div>
        </div>
      </div>
<a href="mixed-effect-model.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exam-questions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": ["STAT340-2018.pdf", "STAT340-2018.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
